<div class="d-flex justify-content-between align-items-center mb-4">
  <h2><i class="fas fa-envelope"></i> Contact Details</h2>
  <a href="/admin/contacts" class="btn btn-outline-secondary">
    <i class="fas fa-arrow-left"></i> Back to Messages
  </a>
</div>

<div class="row">
  <div class="col-md-8">
    <div class="admin-card">
      <div class="card-header bg-transparent border-0 py-3">
        <h5 class="mb-0"><%= contact.subject %></h5>
        <small class="text-muted">
          Received on <%= moment(contact.createdAt).format('MMMM DD, YYYY [at] h:mm A') %>
        </small>
      </div>
      <div class="card-body">
        <div class="mb-4">
          <h6>Message:</h6>
          <div class="bg-light p-3 rounded">
            <%= contact.message.replace(/\n/g, '<br>') %>
          </div>
        </div>

        <% if (contact.notes) { %>
        <div class="mb-4">
          <h6>Internal Notes:</h6>
          <div class="bg-warning bg-opacity-10 p-3 rounded border-start border-warning border-3">
            <%= contact.notes.replace(/\n/g, '<br>') %>
          </div>
        </div>
        <% } %>
      </div>
    </div>
  </div>

  <div class="col-md-4">
    <div class="admin-card mb-4">
      <div class="card-header bg-transparent border-0 py-3">
        <h6 class="mb-0">Contact Information</h6>
      </div>
      <div class="card-body">
        <div class="mb-3">
          <strong>Name:</strong><br>
          <span><%= contact.name %></span>
        </div>
        <div class="mb-3">
          <strong>Email:</strong><br>
          <a href="mailto:<%= contact.email %>"><%= contact.email %></a>
        </div>
        <% if (contact.phone) { %>
        <div class="mb-3">
          <strong>Phone:</strong><br>
          <a href="tel:<%= contact.phone %>"><%= contact.phone %></a>
        </div>
        <% } %>
        <% if (contact.company) { %>
        <div class="mb-3">
          <strong>Company:</strong><br>
          <span><%= contact.company %></span>
        </div>
        <% } %>
      </div>
    </div>

    <div class="admin-card">
      <div class="card-header bg-transparent border-0 py-3">
        <h6 class="mb-0">Update Status</h6>
      </div>
      <div class="card-body">
        <form action="/admin/contacts/<%= contact.id %>?_method=PUT" method="POST">
          <div class="mb-3">
            <label for="status" class="form-label">Status</label>
            <select class="form-select" id="status" name="status">
              <option value="new" <%= contact.status === 'new' ? 'selected' : '' %>>New</option>
              <option value="read" <%= contact.status === 'read' ? 'selected' : '' %>>Read</option>
              <option value="replied" <%= contact.status === 'replied' ? 'selected' : '' %>>Replied</option>
              <option value="closed" <%= contact.status === 'closed' ? 'selected' : '' %>>Closed</option>
            </select>
          </div>

          <div class="mb-3">
            <label for="priority" class="form-label">Priority</label>
            <select class="form-select" id="priority" name="priority">
              <option value="low" <%= contact.priority === 'low' ? 'selected' : '' %>>Low</option>
              <option value="normal" <%= contact.priority === 'normal' ? 'selected' : '' %>>Normal</option>
              <option value="high" <%= contact.priority === 'high' ? 'selected' : '' %>>High</option>
              <option value="urgent" <%= contact.priority === 'urgent' ? 'selected' : '' %>>Urgent</option>
            </select>
          </div>

          <div class="mb-3">
            <label for="notes" class="form-label">Internal Notes</label>
            <textarea class="form-control" id="notes" name="notes" rows="4" placeholder="Add internal notes..."><%= contact.notes || '' %></textarea>
          </div>

          <button type="submit" class="btn btn-admin-primary w-100">
            <i class="fas fa-save"></i> Update Contact
          </button>
        </form>
      </div>
    </div>
  </div>
</div>