<div class="d-flex justify-content-between align-items-center mb-4">
  <h2><i class="fas fa-blog"></i> Blog Management</h2>
  <a href="/admin/blog/new" class="btn btn-admin-primary">
    <i class="fas fa-plus"></i> Write New Post
  </a>
</div>

<div class="admin-card">
  <div class="card-header bg-transparent border-0 py-3">
    <h6 class="mb-0">Total Posts: <%= totalCount %></h6>
  </div>

  <% if (blogs.length > 0) { %>
  <div class="table-responsive">
    <table class="table table-hover">
      <thead>
        <tr>
          <th>Title</th>
          <th>Author</th>
          <th>Category</th>
          <th>Status</th>
          <th>Views</th>
          <th>Date</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        <% blogs.forEach(function(blog) { %>
        <tr>
          <td>
            <div>
              <h6 class="mb-0">
                <% if (blog.featured) { %>
                <i class="fas fa-star text-warning"></i>
                <% } %> <%= blog.title %>
              </h6>
              <small class="text-muted"
                ><%= blog.excerpt.substring(0, 50) %>...</small
              >
            </div>
          </td>
          <td>
            <small><%= blog.author ? blog.author.name : 'Unknown' %></small>
          </td>
          <td>
            <span class="badge bg-secondary text-capitalize"
              ><%= blog.category.replace('-', ' ') %></span
            >
          </td>
          <td>
            <span
              class="badge bg-<%= blog.status === 'published' ? 'success' : blog.status === 'draft' ? 'warning' : 'secondary' %>"
            >
              <%= blog.status.toUpperCase() %>
            </span>
          </td>
          <td>
            <small><%= blog.views %> views</small>
          </td>
          <td>
            <small class="text-muted">
              <%= moment(blog.createdAt).format('MMM DD, YYYY') %>
            </small>
          </td>
          <td>
            <div class="btn-group btn-group-sm">
              <% if (blog.status === 'published') { %>
              <a
                href="/blog/<%= blog.slug %>"
                class="btn btn-outline-info"
                target="_blank"
                title="View"
              >
                <i class="fas fa-eye"></i>
              </a>
              <% } %>
              <a
                href="/admin/blog/<%= blog.id %>/edit"
                class="btn btn-outline-primary"
                title="Edit"
              >
                <i class="fas fa-edit"></i>
              </a>
              <form
                action="/admin/blog/<%= blog.id %>?_method=DELETE"
                method="POST"
                class="d-inline"
                onsubmit="return confirm('Are you sure you want to delete this blog post?')"
              >
                <button
                  type="submit"
                  class="btn btn-outline-danger"
                  title="Delete"
                >
                  <i class="fas fa-trash"></i>
                </button>
              </form>
            </div>
          </td>
        </tr>
        <% }); %>
      </tbody>
    </table>
  </div>

  <!-- Pagination -->
  <% if (totalPages > 1) { %>
  <div class="card-footer bg-transparent">
    <nav>
      <ul class="pagination justify-content-center mb-0">
        <% if (currentPage > 1) { %>
        <li class="page-item">
          <a class="page-link" href="/admin/blog?page=<%= currentPage - 1 %>"
            >Previous</a
          >
        </li>
        <% } %> <% for (let i = Math.max(1, currentPage - 2); i <=
        Math.min(totalPages, currentPage + 2); i++) { %>
        <li class="page-item <%= i === currentPage ? 'active' : '' %>">
          <a class="page-link" href="/admin/blog?page=<%= i %>"><%= i %></a>
        </li>
        <% } %> <% if (currentPage < totalPages) { %>
        <li class="page-item">
          <a class="page-link" href="/admin/blog?page=<%= currentPage + 1 %>"
            >Next</a
          >
        </li>
        <% } %>
      </ul>
    </nav>
  </div>
  <% } %> <% } else { %>
  <div class="card-body text-center py-5">
    <div class="mb-3">
      <i class="fas fa-blog fa-3x text-muted"></i>
    </div>
    <h5>No Blog Posts Found</h5>
    <p class="text-muted">Start by writing your first blog post.</p>
    <a href="/admin/blog/new" class="btn btn-admin-primary">
      <i class="fas fa-plus"></i> Write First Post
    </a>
  </div>
  <% } %>
</div>
